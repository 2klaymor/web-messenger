import {useEffect} from "react";
import {useContext} from "react";
import {Link} from 'react-router-dom';
import ErrorMessage from '../utils/ErrorMessage';

import {LanguageContext, translations} from '../utils/language';
import {ThemeContext, images} from '../utils/theme';

// temp
import {useState} from "react";
import {useNavigate} from "react-router-dom";
import {handleSignIn} from "../features/auth/authHandler";

const SignIn = () => {
    const {language} = useContext(LanguageContext);
    const t = translations[language];
    const {theme} = useContext(ThemeContext);

    // temp
    const [login, setLogin] = useState('');
    const [password, setPassword] = useState('');
    const [errorKey, setErrorKey] = useState('');
    const navigate = useNavigate();

    const handleSubmit = () => {
        const { success} = handleSignIn(login, password);

        if (success) {
            navigate('/home');
            setErrorKey('');
        } else {
            setErrorKey('invalid_data');
        }
    };
    
    return (
        <div className="signin-container">

            {/* top */}
            <img src={images[theme].logo_blur} alt="logo"/>`
            <h1>{t.signin_welcome}</h1>`

            {/* form */}
            <div className="form">

                <label htmlFor="inputLogin">{t.login}</label>
                <input type="email" id="inputLogin"
                       value={login}
                       onChange={(e) => setLogin(e.target.value)}
                       placeholder= "example@example.com"
                />

                <div className="pt-3">
                    <label htmlFor="inputPassword">{t.password}</label>
                    <Link to="#" className="ms-auto float-end">{t.forgot_password}</Link>
                </div>
                <input type="password" id="inputPassword"
                       value={password}
                       onChange={(e) => setPassword(e.target.value)}
                />

                <ErrorMessage errorKey={errorKey}/>
                <button onClick={handleSubmit}>{t.labels.signin}</button>

            </div>

            <p>{t.new_user}&nbsp;
                <Link to="/signup">{t.labels.signup}</Link>
            </p>

        </div>
    )
}

export default SignIn;